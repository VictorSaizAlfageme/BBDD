--EJERCICIO 1

SELECT DEPT_NO , DNOMBRE 
FROM DEPART
WHERE DEPT_NO IN (SELECT DEPT_NO 
                    FROM EMPLE 
                    WHERE COMISION_PCT IS NOT NULL)
GROUP BY DEPT_NO , DNOMBRE;

INSERT INTO EMPLE VALUES(1111,'PEPI','PRESI',NULL,TO_DATE('25/02/2001' , 'DD/MM/YYYY'),15000,6,10);

--EJERCICIO 2

SELECT DEPT_NO , DNOMBRE
FROM DEPART
WHERE DEPT_NO NOT IN (SELECT DEPT_NO 
                        FROM EMPLE 
                        WHERE COMISION_PCT IS NOT NULL)
GROUP BY DEPT_NO , DNOMBRE;

INSERT INTO EMPLE VALUES(2222,'VICTOR','PRESI-2',NULL,TO_DATE('19/09/2003' , 'DD/MM/YYYY'),12000,3,20);

--EJERCICIO 3

SELECT D.DEPT_NO , D.DNOMBRE , COUNT(E.EMP_NO)
FROM DEPART D , EMPLE E
WHERE D.DEPT_NO = E.DEPT_NO
GROUP BY D.DEPT_NO , D.DNOMBRE
HAVING COUNT(E.EMP_NO)=(SELECT MAX(COUNT(E.EMP_NO)) 
                        FROM EMPLE 
                        GROUP BY DEPT_NO);

--COMPROBACION

SELECT D.DEPT_NO , D.DNOMBRE , COUNT(E.EMP_NO)
FROM DEPART D , EMPLE E
WHERE D.DEPT_NO = E.DEPT_NO
GROUP BY D.DEPT_NO , D.DNOMBRE
ORDER BY COUNT(E.EMP_NO)DESC;

--EJERCICIO 4

SELECT D.DEPT_NO , D.DNOMBRE , Z.PROGRAMADORES "PROGRAMADORES"
FROM DEPART D , EMPLE E , (SELECT COUNT(EMP_NO) "PROGRAMADORES" , DEPT_NO 
                            FROM EMPLE 
                            WHERE UPPER(OFICIO)='PROGRAMADOR' GROUP BY DEPT_NO) Z
WHERE D.DEPT_NO = E.DEPT_NO AND D.DEPT_NO = Z.DEPT_NO
GROUP BY D.DEPT_NO , D.DNOMBRE , Z.PROGRAMADORES
HAVING PROGRAMADORES=MAX(Z.PROGRAMADORES);

SELECT MAX(COUNT(EMP_NO)) 
FROM EMPLE 
WHERE UPPER(OFICIO)='PROGRAMADOR' 
GROUP BY DEPT_NO;

--EJERCICIO 5

SELECT DEPT_NO , DNOMBRE 
FROM DEPART;

